<!DOCTYPE html>
<html {{- if (eq .Site.Params.mode "dark" ) -}}class="dark" {{ end }}>
{{ partial "header.html" . }}

<body>
  <div class="container wrapper">
    {{ partial "head.html" . }}
    <div class="recent-posts section">
      <div class="posts">

        {{/* ----------------------------------------------------------------------- */}}
        {{/* Logic Block: è³‡æ–™æº–å‚™èˆ‡åˆ†çµ„é‚è¼¯ */}}
        {{/* ----------------------------------------------------------------------- */}}

        {{/* 1. æŠ“å–æ–‡ç« ï¼šé™åˆ¶åœ¨ config è¨­å®šçš„ mainSections (é€šå¸¸æ˜¯ posts) */}}
        {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}

        {{/* 2. éæ¿¾ï¼šå‰”é™¤è¨­å®šç‚º hidden: true çš„æ–‡ç«  */}}
        {{ $pages = where $pages "Params.hidden" "ne" true }}

        {{/* 3. åˆ†æµï¼šå°‡æ–‡ç« æ‹†åˆ†ç‚ºã€Œç½®é ‚ã€èˆ‡ã€Œéç½®é ‚ã€å…©çµ„ */}}
        {{/* - pinned: true çš„æ–‡ç« æ”¾å…¥ $pinnedPosts */}}
        {{/* - å…¶é¤˜æ–‡ç« æ”¾å…¥ $regularPosts */}}
        {{ $pinnedPosts := where $pages "Params.pinned" true }}
        {{ $regularPosts := where $pages "Params.pinned" "!=" true }}

        {{/* 4. åˆ†é è¨­å®šï¼šæˆ‘å€‘åªå°ã€Œéç½®é ‚ã€çš„æ–‡ç« é€²è¡Œåˆ†é  */}}
        {{/* é€™æ¨£åšæ˜¯ç‚ºäº†ä¿è­‰ç½®é ‚æ–‡ç« æ°¸é åªå‡ºç¾åœ¨ç¬¬ä¸€é çš„é ‚éƒ¨ï¼Œä¸æœƒå¹²æ“¾åˆ†é è¨ˆç®— */}}
        {{ $paginator := .Paginate $regularPosts }}


        {{/* ----------------------------------------------------------------------- */}}
        {{/* View Block: ç½®é ‚æ–‡ç« å€å¡Š (Pinned Section) */}}
        {{/* ----------------------------------------------------------------------- */}}

        {{/* æ¢ä»¶ï¼šç•¶å‰å¿…é ˆæ˜¯ã€Œç¬¬ 1 é ã€ ä¸” ã€Œæœ‰ç½®é ‚æ–‡ç« ã€æ‰é¡¯ç¤ºæ­¤å€å¡Š */}}
        {{ if and (eq $paginator.PageNumber 1) $pinnedPosts }}
        <div class="pinned-section">
          <!-- æ¨™ç¤ºæ–‡å­— (å¯é¸) -->
          <div class="section-label">ğŸ“Œ ç½®é ‚</div>

          <!-- éæ­·ç½®é ‚æ–‡ç«  -->
          {{ range $pinnedPosts }}
          <!-- å‘¼å«ä¸‹æ–¹å®šç¾©çš„ "post_item" æ¨¡æ¿ï¼Œå‚³å…¥ç•¶å‰æ–‡ç« ä¸Šä¸‹æ–‡ (.) -->
          {{ template "post_item" . }}
          {{ end }}
        </div>

        <!-- åˆ†éš”ç·šï¼šç”¨ä¾†å€éš”ç½®é ‚èˆ‡ä¸€èˆ¬æ–‡ç«  -->
        <div class="pinned-separator"></div>
        {{ end }}


        {{/* ----------------------------------------------------------------------- */}}
        {{/* View Block: ä¸€èˆ¬æ–‡ç« å€å¡Š (Regular Section) */}}
        {{/* ----------------------------------------------------------------------- */}}

        <div class="regular-section">
          <!-- éæ­·åˆ†é éå¾Œçš„æ–‡ç«  (é€™è£¡åªæœ‰éç½®é ‚æ–‡ç« ) -->
          {{ range $paginator.Pages }}
          {{ template "post_item" . }}
          {{ end }}
        </div>

        <!-- é¡¯ç¤ºåˆ†é å°èˆª (ä¸Šä¸€é /ä¸‹ä¸€é ) -->
        {{ template "partials/paginator.html" . }}

      </div>
    </div>
  </div>
  {{ partial "footer.html" . }}
</body>

{{/* ----------------------------------------------------------------------- */}}
{{/* Template Define: å–®ç¯‡æ–‡ç« å¡ç‰‡æ¨¡æ¿ */}}
{{/* ç‚ºäº†é¿å… HTML é‡è¤‡å…©æ¬¡ (ç½®é ‚ä¸€æ¬¡ã€ä¸€èˆ¬ä¸€æ¬¡)ï¼Œæˆ‘å€‘å°‡çµæ§‹æŠ½å–å‡ºä¾†å®šç¾©åœ¨é€™è£¡ */}}
{{/* ----------------------------------------------------------------------- */}}
{{ define "post_item" }}
<div class="post {{ if .Params.pinned }}pinned-post{{ end }}">
  <div class="post-header">
    <div class="matter">
      <!-- æ¨™é¡Œ -->
      <h4 class="title small">
        <a href="{{ .RelPermalink }}">
          {{.Title}}
          {{ if .Draft }}<sup class="draft-label">DRAFT</sup>{{ end }}
        </a>
      </h4>

      <!-- æ—¥æœŸè³‡è¨Š - æ°´å¹³æ’åˆ— -->
      <div class="date-row">
        <div class="publish-date">
          ç™¼ä½ˆæ–¼ {{ .Date.Format "2006-01-02" }}
        </div>

        {{ if and (ne .Lastmod .Date) (gt .Lastmod .Date) }}
        <div class="lastmod-subtle-container">
          {{ .Lastmod.Format "2006-01-02" }} æ›´æ–°
        </div>
        {{ end }}
      </div>

      <!-- Taxonomy: é¡¯ç¤º Categories èˆ‡ Tags -->
      <h4 class="title small smaller taxonomy-list">
        <!-- Categories (@Title) -->
        {{ if .Params.categories }}
        <ul class="tags flat category-list">
          {{ range first .Site.Params.maxTags .Params.categories }}
          <li class="tag-li">
            <!-- ä½¿ç”¨ relLangURL è™•ç†å¤šèªè¨€è·¯å¾‘ -->
            <a href="{{ "categories/" | relLangURL }}{{ . | urlize }}">
              <span class="taxonomy-icon">@</span>{{ . }}
            </a>
          </li>
          {{ end }}
        </ul>
        {{ end }}

        <!-- Tags (#Title) -->
        {{ if .Params.tags }}
        <ul class="tags flat tag-list">
          {{ range first .Site.Params.maxTags .Params.tags }}
          <li class="tag-li">
            <a href="{{ "tags/" | relLangURL }}{{ . | urlize }}">
              <span class="taxonomy-icon">#</span>{{ . }}
            </a>
          </li>
          {{ end }}
        </ul>
        {{ end }}
      </h4>

      <!-- æ–‡ç« æ‘˜è¦ -->
      <span class="description">
        {{ if isset .Params "description" }}
        {{ .Description }}
        {{ else if gt (len .RawContent) 120 }}
        {{ slicestr .RawContent 0 120 }}...
        {{ else }}
        {{ .RawContent }}
        {{ end }}
      </span>
    </div>
  </div>
</div>
{{ end }}

<!-- ç°¡å–®çš„ CSS æ¨£å¼ (å»ºè­°ç§»è‡³ style.css) -->
<style>
  /* ç½®é ‚å€å¡Šæ¨™é¡Œ */
  .section-label {
    font-size: 1rem;
    font-weight: bold;
    color: #999;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  /* åˆ†éš”ç·šï¼šè™›ç·šæ¨£å¼ */
  .pinned-separator {
    border-top: 2px dashed #e0e0e0;
    margin: 3rem 0;
    /* ä¸Šä¸‹é–“è· */
    position: relative;
  }

  /* Dark mode é©é… */
  .dark .pinned-separator {
    border-top-color: #444;
  }
</style>

</html>